#!/bin/bash

# Script para iniciar la API principal (que incluye WebSocket)
echo "ðŸš€ Iniciando API principal con WebSocket integrado..."

# FunciÃ³n para manejar la seÃ±al de terminaciÃ³n
cleanup() {
    echo "ðŸ›‘ Deteniendo servicios..."
    kill $API_PID 2>/dev/null
    exit 0
}

# Configurar trap para manejar seÃ±ales
trap cleanup SIGTERM SIGINT

# Iniciar API principal en background (incluye WebSocket)
echo "ðŸ“¡ Iniciando API principal en puerto 8000..."
uvicorn main:app --host 0.0.0.0 --port 8000 --reload False &
API_PID=$!

echo "âœ… Servicio iniciado:"
echo "   - API Principal: http://localhost:8000"
echo "   - WebSocket: ws://localhost:8000/ws/{client_id}"
echo "   - Health: http://localhost:8000/health"
echo "   - DocumentaciÃ³n: http://localhost:8000/docs"

# Esperar a que el proceso termine
wait $API_PID 